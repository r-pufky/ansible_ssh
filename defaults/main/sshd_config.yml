---
# yamllint disable rule:line-length
###############################################################################
# SSH Global Server Configuration (/etc/ssh/sshd_config)
###############################################################################
# Use referenced man pages for detailed option usage.
#
# List current system configuration using:
#
#   sshd -T
#
# List ciphers using:
#
#   ssh -Q help; ssh -Q key
#
# Define Host and Match directives within ssh_server_include_files.
#
# See reference sections for syntax formats:
# * TOKEN (string replacement tokens)
# * TIME (time formats)
# * PATTERNS (string matching)
# * ENV (environment variables runtime expansion)
#
# Reference:
# * https://manpages.debian.org/trixie/openssh-server/sshd_config.5.en.html
# * https://manpages.debian.org/trixie/openssh-server/sshd_config.5.en.html#TOKENS
# * https://manpages.debian.org/trixie/openssh-server/sshd_config.5.en.html#TIME_FORMATS
# * https://manpages.debian.org/trixie/openssh-server/sshd_config.5.en.html#AUTHORIZED_KEYS
# * https://manpages.debian.org/trixie/openssh-client/ssh_config.5.en.html#PATTERNS

# Source include directives from location.
#
# Additional directives are included before global configuration values. Manage
# included files with ssh_server_include_files.
#
# Special Case:
#        *: ssh_server_include_files using base directory of first element to
#           manage files.
#        *: Wildcards will be expanded in lexical order.
#       []: Disable includes.
#   {PATH}: Relative paths anchored to /etc/ssh.
#
# Values:
#   {PATTERN}: PATTERN host match.
#
# Default:
#   - '/etc/ssh/sshd_config.d/*.conf'
ssh_server_include:
  - '/etc/ssh/sshd_config.d/*.conf'

# Client environment variables that should be accepted on the server.
#
# Variables are specified by name which may contain wildcard characters. See
# PATTERNS for more information on patterns.
#
# Be warned that some environment variables could be used to bypass restricted
# user environments. Care should be taken in the use of this directive.
#
# Default:
#   - 'LANG LC_*'
ssh_server_accept_env:
  - 'LANG LC_*'

# Address family to use for SSHD.
#
# Values:
#     any: Use any address family (default).
#    inet: Use IPv4 only.
#   inet6: Use IPv6 only.
#
# Default: 'any'.
ssh_server_address_family: 'any'

# Allow ssh-agent forwarding?
#
# Disabling agent forwarding does not improve security unless users are also
# denied shell access, as they can always install their own forwarders.
#
# Default: True.
ssh_server_allow_agent_forwarding: true

# Allow login for users with matching primary or supplementary groups.
#
# Allow/deny groups directives are processed in the following order:
# * DenyGroups
# * AllowGroups
#
# Special Case:
#   {PATTERN}: PATTERN group match.
#     {GROUP}: Group name - GID (numerical group ID) not allowed.
#          []: Allow all groups (default).
#
# Default: [] (allow all).
ssh_server_allow_groups: []

# Permit stream local (Unix-domain socket) forwarding?
#
# Disabling stream local forwarding does not improve security unless users are
# also denied shell access, as they can always install their own forwarders.
#
# Values:
#     True: Allow all (default).
#      all: Allow all.
#    local: Allow local only (from the perspective of SSH).
#   remote: Allow remote only.
#    False: Prevent all.
#
# Default: True.
ssh_server_allow_stream_local_forwarding: true

# Permit TCP forwarding?
#
# Disabling TCP forwarding does not improve security unless users are also
# denied shell access, as they can always install their own forwarders.
#
# Values:
#     True: Allow all (default).
#      all: Allow all.
#    local: Allow local only (from the perspective of SSH).
#   remote: Allow remote only.
#    False: Prevent all.
#
# Default: True.
ssh_server_allow_tcp_forwarding: true

# Allow logins only for user names that match one of the patterns.
#
# Allow/deny users directives are processed in the following order:
# * DenyUsers
# * AllowUsers
#
# Special Case:
#       {PATTERN}: PATTERN user match.
#   {USER}@{CIDR}: PATTERN user match - USER and HOST are separately checked,
#                  restricting logins to particular users from particular
#                  hosts. HOST criteria may additionally contain addresses to
#                  match in CIDR format.
#          {USER}: User name - UID (numerical user ID) not allowed.
#              []: Allow all users (default).
#
# Default: [] (allow all).
ssh_server_allow_users: []

# Authentication methods that must succeed for a user to be granted access.
#
# If the default (any) is overridden, then successful authentication requires
# completion of every method in at least one of these lists. Each method
# enabled MUST BE explicitly enabled in configuration as well.
#
# Values:
#                            any: accept any single authentication method
#                                 (default).
#                gssapi-with-mic: GSSAPI authentication.
#                      hostbased: Host based authentication.
#           keyboard-interactive: Any keyboard interactive authentication.
#   keyboard-interactive:bsdauth: BSD auth keyboard interactive only.
#       keyboard-interactive:pam: PAM auth keyboard interactive only.
#                           none: Passwordless authentication when
#                                 ssh_server_permit_empty_passwords is True.
#                       password: Password authentication.
#                      publickey: Publickey authentication; if listed more
#                                 than once, SSH verifies that keys that have
#                                 been used successfully are not reused for
#                                 subsequent authentications. e.g.:
#                                 'publickey,publickey' requires successful
#                                 authentication using two different keys.
#
# Only methods that are next in one or more lists are offered at each stage, so
# for this example it would not be possible to attempt password or
# keyboard-interactive authentication before public key:
#
#   ssh_server_authentication_methods:
#     - - 'publickey'
#       - 'password'
#     - - 'publickey'
#       - 'keyboard-interactive'
#     - - 'publickey'
#       - 'publickey'
#
# Default: [] (any).
ssh_server_authentication_methods: []

# Program to look up user public keys.
#
# Requires ssh_server_authorized_keys_command_user set.
#
# The program should produce on standard output zero or more lines of
# AUTHORIZED_KEYS output (see reference). ssh_server_authorized_keys_command is
# tried after the usual ssh_server_authorized_keys_file files and will not be
# executed if a matching key is found there.
#
# Special Case:
#     {TOKEN}: TOKEN FORMAT supported.
#
# Values:
#   {COMMAND}: Command to run. File must be an absolute path, owned by root,
#              and not writable by groups or others. If no arguments are
#              specified then the username of the target user is used.
#          '': 'none' - explicitly disable command (default).
#
# Default: '' (disabled).
ssh_server_authorized_keys_command: ''

# User to run ssh_server_authorized_keys_command.
#
# Requires ssh_server_authorized_keys_command set.
#
# Recommend using a dedicated user on host that only runs authorized keys
# commands.
#
# Values:
#   {USER}: User name.
#       '': 'none' - explicitly disable command (default).
#
# Default: '' (disable).
ssh_server_authorized_keys_command_user: ''

# Files that contain public keys for user authentication
#
# Special Case:
#   {TOKEN}: TOKEN FORMAT supported.
#        '': Skip checking for user keys in files.
#
# Values:
#   {PATH}: Absolute path or relative path anchored to user's home directory.
#
# Default:
#   - '.ssh/authorized_keys'
#
# Reference:
# * https://marc.info/?l=openssh-unix-dev&m=100508718416162
ssh_server_authorized_keys_file:
  - '.ssh/authorized_keys'

# Program to generate list of allowed certificate principals.
#
# Requires ssh_server_authorized_principals_command_user set.
#
# The program should produce on standard output zero or more lines of
# ssh_server_authorized_principals_file output. Certificates offered by client
# for authentication must contain a principal that is listed in:
# * ssh_server_authorized_principals_command
# * ssh_server_authorized_principals_file
#
# Special Case:
#     {TOKEN}: TOKEN FORMAT supported.
#
# Values:
#   {COMMAND}: Command to run. File must be an absolute path, owned by root,
#              and not writable by groups or others. If no arguments are
#              specified then the username of the target user is used.
#          '': 'none' - explicitly disable command (default).
#
# Default: '' (disabled).
ssh_server_authorized_principals_command: ''

# User to run ssh_server_authorized_principals_command.
#
# Requires ssh_server_authorized_principals_command set.
#
# Recommend using a dedicated user on host that only runs authorized principals
# commands.
#
# Values:
#   {USER}: User name.
#       '': 'none' - explicitly disable command (default).
#
# Default: '' (disable).
ssh_server_authorized_principals_command_user: ''

# File listing principal names accepted for certificate authentication.
#
# ssh_server_authorized_principals_file is only used when authentication
# proceeds using a CA listed in ssh_server_trusted_user_ca_keys and is not
# consulted for certification authorities trusted via ~/.ssh/authorized_keys;
# though principals= key option offers a similar facility.
#
# Special Case:
#     {TOKEN}: TOKEN FORMAT supported.
#
# Values:
#   {PATH}: Absolute path or relative path anchored to user's home directory.
#       '': 'none' - no principals file (disabled) - username of user must
#           appear in a certificate's principals list for it to be accepted
#           (default).
#
# Default: '' (disabled).
ssh_server_authorized_principals_file: ''

# Pre-login banner.
#
# Values:
#   {CONTENTS}: Contents of banner; file automatically managed in
#               /etc/ssh/ssh_server_banner.
#           '': 'none' - No pre-login banner (disabled) (default).
#
# Default: '' (disabled).
ssh_server_banner: ''

# Algorithms allowed for signing of certificates by certificate authorities.
#
# SSHD will not accept host certificates signed using algorithms other than
# those specified.
#
# List supported algorithms with:
#
#   ssh -Q key
#
# Special Case:
# * Algorithm lists cannot use modifiers (+, -, etc).
#
# Default:
#   - 'ssh-ed25519'
#   - 'ecdsa-sha2-nistp256'
#   - 'ecdsa-sha2-nistp384'
#   - 'ecdsa-sha2-nistp521'
#   - 'sk-ssh-ed25519@openssh.com'
#   - 'sk-ecdsa-sha2-nistp256@openssh.com'
#   - 'rsa-sha2-512'
#   - 'rsa-sha2-256'
ssh_server_ca_signature_algorithms:
  - 'ssh-ed25519'
  - 'ecdsa-sha2-nistp256'
  - 'ecdsa-sha2-nistp384'
  - 'ecdsa-sha2-nistp521'
  - 'sk-ssh-ed25519@openssh.com'
  - 'sk-ecdsa-sha2-nistp256@openssh.com'
  - 'rsa-sha2-512'
  - 'rsa-sha2-256'

# How quickly to close inactive SSH channels.
#
# In all the above cases, terminating an inactive session does not guarantee to
# remove all resources associated with the session, e.g. shell processes or X11
# clients relating to the session may continue to execute.
#
# Moreover, terminating an inactive channel or session does not necessarily
# close the SSH connection, nor does it prevent a client from requesting
# another channel of the same type. In particular, expiring an inactive
# forwarding session does not prevent another identical forwarding from being
# subsequently created.
#
# Special Case:
#   {TIME}: All options support TIME FORMAT.
#        0: Disables timeout for specific option.
#       []: 'none' - Disables channel timeouts (default).
#
# ssh_server_channel_timeout:
#     list of dict - one or more channel type and time specifications
#   - global: TIME - Applies to all active channels (measured together).
#         Traffic on any active channel resets timeout. All connections closed
#         when timeout elapses.
#   - agent-connection: TIME - Open connections to ssh-agent.
#   - direct-tcpip: TIME - Open TCP socket connections that have been
#         established from ssh local forwarding (LocalForward, DynamicForward).
#   - direct-streamlocal@openssh.com: TIME - Open Unix socket connections that
#         have been established from ssh local forwarding (LocalForward,
#         DynamicForward).
#   - forwarded-tcpip: TIME - Open TCP socket connections that have been
#         established to sshd listening on behalf of ssh remote forwarding
#         (RemoteForward).
#   - forwarded-streamlocal@openssh.com: TIME - Open TCP unix
#         connections that have been established to sshd listening on behalf of
#         ssh remote forwarding (RemoteForward).
#   - session: TIME - Interactive sessions - shell, session, commands, scp,
#         sfp, etc.
#   - tun-connection: TIME - Open ssh_client_tunnel_forward connections.
#   - x11-connection: TIME - Open X11 forwarding sessions.
#
# ssh_server_channel_timeout:
#   - session: '5m'
#   - tun-connection: '1h'
#   - *: '30m'
#
# Default: [] (disabled)
ssh_server_channel_timeout: []

# Directory directory to chroot to after authentication.
#
# It is very important that the directory hierarchy be prevented from
# modification by other processes on the system (especially those outside the
# jail). Misconfiguration can lead to UNSAFE environments which SSHD cannot
# detect.
#
# Directory must contain the necessary files and directories to support user
# sessions:
#   interactive: Shell (typically sh) and basic /dev nodes such as null, zero,
#                stdin, stdout, stderr, and tty devices.
#          SFTP: No additional configuration necessary if the in-process
#                sftp-server is used, though sessions which use logging may
#                require /dev/log inside the chroot directory.
#
# Special Case:
#     {TOKEN}: TOKEN FORMAT supported.
#
# Values:
#   {PATH}: All path components must owned by root, and not writable by any
#           other user or group. Working directory changed to user home
#           directory.
#       '': 'none' - explicitly disable chroot (default).
#
# Default: '' (disabled).
ssh_server_chroot_directory: ''

# Ciphers allowed in order of preference.
#
# List supported ciphers with:
#
#   ssh -Q Ciphers
#
# Security: CVE-2023-48795
#   CVE:
#   * https://nvd.nist.gov/vuln/detail/cve-2023-48795
#   * https://nvd.nist.gov/vuln/detail/cve-2023-46445
#   * https://nvd.nist.gov/vuln/detail/cve-2023-46446
#   * https://nvd.nist.gov/vuln/detail/cve-2024-41909
#   Decision: remove chacha20 cipher, *-etm MAC - disables attack for modern
#       systems, remove when OpenSSH 9.6 released with strict key exchange.
#   Mitigation:
#   * remove 'chacha20-poly1305@openssh.com' from client ciphers.
#   * remove '*-etm@openssh.com' from server macs.
#   Reference:
#   * https://terrapin-attack.com/#scanner
#   * https://www.openssh.com/txt/release-9.6
#
# Special Case:
# * Algorithm lists cannot use modifiers (+, -, etc).
#
# Default:
#   # - 'chacha20-poly1305@openssh.com'
#   - 'aes128-ctr'
#   - 'aes192-ctr'
#   - 'aes256-ctr'
#   - 'aes128-gcm@openssh.com'
#   - 'aes256-gcm@openssh.com'
ssh_server_ciphers:
  - 'aes128-ctr'
  - 'aes192-ctr'
  - 'aes256-ctr'
  - 'aes128-gcm@openssh.com'
  - 'aes256-gcm@openssh.com'

# Number of client alive messages without receiving any messages back.
#
# Client alive messages are sent through encrypted channel and therefore will
# not be spoofable. TCP keepalive option enabled by ssh_server_tcp_keep_alive
# is spoofable. Server alive mechanism is valuable when client or server depend
# on knowing when a connection has become unresponsive.
#
# For example if ssh_server_client_alive_interval is 15 and
# ssh_server_client_alive_count_max is 3, if the server becomes unresponsive,
# SSH will disconnect after approximately 45 seconds.
#
# Default: 3.
ssh_server_client_alive_count_max: 3

# Timeout interval in seconds if no data received to send a client response.
#
# Sends a message through encrypted channel to request a response from client.
#
# Special Case:
#     0: Never send messages to client (default).
#
# Default: 0 (disabled).
ssh_server_client_alive_interval: 0

# Enable compression?
#
# Special Case:
#   delayed: Deprecated legacy option that equates to True.
#
# Default: True.
ssh_server_compression: true

# Include distribution specific version suffix in handshake? Default: True.
ssh_server_os_banner: true

# Deny login for users with matching primary or supplementary groups.
#
# Allow/deny groups directives are processed in the following order:
# * DenyGroups
# * AllowGroups
#
# Special Case:
#   {PATTERN}: PATTERN group match.
#     {GROUP}: Group name - GID (numerical group ID) not allowed.
#          []: Allow all groups (default).
#
# Default: [] (allow all).
ssh_server_deny_groups: []

# Deny logins only for user names that match one of the patterns.
#
# Allow/deny users directives are processed in the following order:
# * DenyUsers
# * AllowUsers
#
# Special Case:
#       {PATTERN}: PATTERN user match.
#   {USER}@{CIDR}: PATTERN user match - USER and HOST are separately checked,
#                  restricting logins to particular users from particular
#                  hosts. HOST criteria may additionally contain addresses to
#                  match in CIDR format.
#          {USER}: User name - UID (numerical user ID) not allowed.
#              []: Allow all users (default).
#
# Default: [] (allow all).
ssh_server_deny_users: []

# Disable forwarding (all including: X11, ssh-agent, TCP, StreamLocal)?
#
# Overrides all other forwarding-related options and may simplify restricted
# configurations.
#
# Default: False.
ssh_server_disable_forwarding: false

# Expose authentication methods and public credentials to SSH_USER_AUTH?
#
# Default: False.
ssh_server_expose_auth_info: false

# Hash algorithm used when logging key fingerprints.
#
# Values:
#      md5: Show MD5 hash.
#   sha256: Show SHA256 hash.
#
# Default: 'sha256'
ssh_server_fingerprint_hash: 'sha256'

# Force execution of command specified.
#
# Ignores any command supplied by the client and ~/.ssh/rc if present.
#
# It is most useful inside a Match block. Command originally supplied by client
# is available in the SSH_ORIGINAL_COMMAND environment variable.
#
# Values:
#       {COMMAND}: Command to invoke using user login shell with -c option.
#                  Applies to shell, command, or subsystem execution.
#   internal-sftp: Force use of an in-process SFTP server that requires no
#                  support files when used with ssh_server_chroot_directory.
#              '': 'none' - disabled (default).

# Default: '' (disabled).
ssh_server_force_command: ''

# Allow remote hosts to connect to ports forwarded for client?
#
# Values:
#              True: Force remote port forwards to bind to wildcard addresses.
#   clientspecified: Allow client to select address to bind port forward.
#             False: Force remote port forwards to bind to localhost; prevents
#                    other remote hosts from connecting to forwarded ports
#                    (default).
#
# Default: False.
ssh_server_gateway_ports: false

# Allow authentication based on GSSAPI? Default: False.
ssh_server_gssapi_authentication: false

# Automatically destroy user credential cache on logout? Default: True.
ssh_server_gssapi_cleanup_credentials: true

# Allow key exchange based on GSSAPI? Default: False.
ssh_server_gssapi_key_exchange: false

# Strict check identity of GSSAPI acceptor client authenticated against?
#
# Values:
#    True: Client must authenticate against host service on current hostname.
#   False: Client may authenticate against any service key stored in machine's
#          default store. This facility is provided to assist with operation on
#          multi homed machines.
#
# Default: True.
ssh_server_gssapi_strict_acceptor_check: true

# Update user GSSAPI credentials on successful connection rekeying?
#
# Used to accepted renewed or updated credentials from a compatible client.
# ssh_server_gssapi_key_exchange needs to be enabled on server and also used by
# client.
#
# Default: False.
ssh_server_gssapi_store_credentials_on_rekey: false

# Algorithms for GSSAPI key exchange (kex).
#
# List supported algorithms with:
#
#   ssh -Q kex-gss
#
# Special Case:
# * Algorithm lists cannot use modifiers (+, -, etc).
#
# Default:
#   - 'gss-group14-sha256-'
#   - 'gss-group16-sha512-'
#   - 'gss-nistp256-sha256-'
#   - 'gss-curve25519-sha256-'
#   - 'gss-group14-sha1-'
#   - 'gss-gex-sha1-'
ssh_server_gssapi_kex_algorithms:
  - 'gss-group14-sha256-'
  - 'gss-group16-sha512-'
  - 'gss-nistp256-sha256-'
  - 'gss-curve25519-sha256-'
  - 'gss-group14-sha1-'
  - 'gss-gex-sha1-'

# Algorithms used for host based authentication.
#
# List supported algorithms with:
#
#   ssh -Q HostbasedAcceptedAlgorithms
#
# Special Case:
# * Algorithm lists cannot use modifiers (+, -, etc).
#
# Default:
#   - 'ssh-ed25519-cert-v01@openssh.com'
#   - 'ecdsa-sha2-nistp256-cert-v01@openssh.com'
#   - 'ecdsa-sha2-nistp384-cert-v01@openssh.com'
#   - 'ecdsa-sha2-nistp521-cert-v01@openssh.com'
#   - 'sk-ssh-ed25519-cert-v01@openssh.com'
#   - 'sk-ecdsa-sha2-nistp256-cert-v01@openssh.com'
#   - 'rsa-sha2-512-cert-v01@openssh.com'
#   - 'rsa-sha2-256-cert-v01@openssh.com'
#   - 'ssh-ed25519'
#   - 'ecdsa-sha2-nistp256'
#   - 'ecdsa-sha2-nistp384'
#   - 'ecdsa-sha2-nistp521'
#   - 'sk-ssh-ed25519@openssh.com'
#   - 'sk-ecdsa-sha2-nistp256@openssh.com'
#   - 'rsa-sha2-512'
#   - 'rsa-sha2-256'
ssh_server_hostbased_accepted_algorithms:
  - 'ssh-ed25519-cert-v01@openssh.com'
  - 'ecdsa-sha2-nistp256-cert-v01@openssh.com'
  - 'ecdsa-sha2-nistp384-cert-v01@openssh.com'
  - 'ecdsa-sha2-nistp521-cert-v01@openssh.com'
  - 'sk-ssh-ed25519-cert-v01@openssh.com'
  - 'sk-ecdsa-sha2-nistp256-cert-v01@openssh.com'
  - 'rsa-sha2-512-cert-v01@openssh.com'
  - 'rsa-sha2-256-cert-v01@openssh.com'
  - 'ssh-ed25519'
  - 'ecdsa-sha2-nistp256'
  - 'ecdsa-sha2-nistp384'
  - 'ecdsa-sha2-nistp521'
  - 'sk-ssh-ed25519@openssh.com'
  - 'sk-ecdsa-sha2-nistp256@openssh.com'
  - 'rsa-sha2-512'
  - 'rsa-sha2-256'

# Host based authentication with public key authentication? Default: False.
ssh_server_hostbased_authentication: false

# Perform a reverse lookup when matching host names.
#
# Enabling uses name supplied by client rather than attempting to resolve name
# from TCP connection itself.
#
# Default: False.
ssh_server_hostbased_uses_name_from_packet_only: false

# Public host certificate.
#
# Requires: Certificate public key must match a private host key already
#     specified by ssh_server_host_key.
#
# Values:
#   {CONTENTS}: Contents of host certificate - file automatically managed in
#               /etc/ssh/ssh_server_host_certificate.
#           '': Disabled.
#
# Default: '' (disabled).
ssh_server_host_certificate: ''

# Absolute file paths or contents containing a private host key.
#
# SSHD will refuse to use a file if it is group/world-accessible, and
# ssh_server_host_key_algorithms restrictions. DSA keys are considered
# insecure. These are forcibly removed in SSH 9.8.
#
# Values:
#     [{FILE}]: Paths to files containing host key (not managed).
#   {CONTENTS}: Contents of host key - file will be managed automatically in
#               /etc/ssh/ssh_server_host_key.
#           '': Disabled.
#
# Default:
#   - '/etc/ssh/ssh_host_rsa_key'
#   - '/etc/ssh/ssh_host_ecdsa_key'
#   - '/etc/ssh/ssh_host_ed25519_key'
ssh_server_host_key:
  - '/etc/ssh/ssh_host_rsa_key'
  - '/etc/ssh/ssh_host_ecdsa_key'
  - '/etc/ssh/ssh_host_ed25519_key'

# Unix socket to communicate with agent for private host keys.
#
# Special Case:
#   SSH_AUTH_SOCK: Location of socket read from SSH_AUTH_SOCK environment
#                  variable.
#              '': 'none' - Disabled (default).
#
# Default: '' (disabled).
ssh_server_host_key_agent: ''

# Server host key signature algorithm preference.
#
# List supported algorithms with:
#
#   ssh -Q HostKeyAlgorithms
#
# Special Case:
# * Algorithm lists cannot use modifiers (+, -, etc).
#
# Default:
#   - 'ssh-ed25519-cert-v01@openssh.com'
#   - 'ecdsa-sha2-nistp256-cert-v01@openssh.com'
#   - 'ecdsa-sha2-nistp384-cert-v01@openssh.com'
#   - 'ecdsa-sha2-nistp521-cert-v01@openssh.com'
#   - 'sk-ssh-ed25519-cert-v01@openssh.com'
#   - 'sk-ecdsa-sha2-nistp256-cert-v01@openssh.com'
#   - 'rsa-sha2-512-cert-v01@openssh.com'
#   - 'rsa-sha2-256-cert-v01@openssh.com'
#   - 'ssh-ed25519'
#   - 'ecdsa-sha2-nistp256'
#   - 'ecdsa-sha2-nistp384'
#   - 'ecdsa-sha2-nistp521'
#   - 'sk-ssh-ed25519@openssh.com'
#   - 'sk-ecdsa-sha2-nistp256@openssh.com'
#   - 'rsa-sha2-512'
#   - 'rsa-sha2-256'
ssh_server_host_key_algorithms:
  - 'ssh-ed25519-cert-v01@openssh.com'
  - 'ecdsa-sha2-nistp256-cert-v01@openssh.com'
  - 'ecdsa-sha2-nistp384-cert-v01@openssh.com'
  - 'ecdsa-sha2-nistp521-cert-v01@openssh.com'
  - 'sk-ssh-ed25519-cert-v01@openssh.com'
  - 'sk-ecdsa-sha2-nistp256-cert-v01@openssh.com'
  - 'rsa-sha2-512-cert-v01@openssh.com'
  - 'rsa-sha2-256-cert-v01@openssh.com'
  - 'ssh-ed25519'
  - 'ecdsa-sha2-nistp256'
  - 'ecdsa-sha2-nistp384'
  - 'ecdsa-sha2-nistp521'
  - 'sk-ssh-ed25519@openssh.com'
  - 'sk-ecdsa-sha2-nistp256@openssh.com'
  - 'rsa-sha2-512'
  - 'rsa-sha2-256'

# Use per user .rhosts/.shosts files with ssh_server_hostbased_authentication?
#
# System wide /etc/hosts.equiv and /etc/ssh/shosts.equiv are still used
# regardless of this setting.
#
# Values:
#          True: Ignore rhosts/shosts (default).
#   shosts-only: Ignore rhosts, allow shosts.
#         False: Allow rhosts/shosts.
#
# Default: True.
ssh_server_ignore_rhosts: true

# Ignore user ~/.ssh/known_hosts during ssh_server_hostbased_authentication?
#
# System wide /etc/ssh/ssh_known_hosts will be used instead.
#
# Default: False.
ssh_server_ignore_user_known_hosts: false

# Specifies the IPv4 type-of-service or DSCP class for connections.
#
# list of str - SSH QOS client connections.
#
# Special Case:
# * If one argument is specified it is used as packet class unconditionally.
# * If two values are specified first is automatically selected for interactive
#   sessions and second for non-interactive sessions.
#
# Values:
#          af11: DSCP 10 (class 1 - low).
#          af12: DSCP 12 (class 1 - medium).
#          af13: DSCP 14 (class 1 - high).
#          af21: DSCP 18 (class 2 - low).
#          af22: DSCP 20 (class 2 - medium).
#          af23: DSCP 22 (class 2 - high).
#          af31: DSCP 26 (class 3 - low).
#          af32: DSCP 28 (class 3 - medium).
#          af33: DSCP 30 (class 3 - high).
#          af41: DSCP 34 (class 4 - low).
#          af42: DSCP 36 (class 4 - medium).
#          af43: DSCP 38 (class 4 - high).
#           cs0: DSCP 0 (standard).
#           cs1: DSCP 8 (low-priority data).
#           cs2: DSCP 16 (network operations, administration/management OAM).
#           cs3: DSCP 24 (broadcast video).
#           cs4: DSCP 32 (real-time interactive).
#           cs5: DSCP 40 (signaling).
#           cs6: DSCP 48 (network control).
#           cs7: DSCP 56 (reserved).
#            ef: DSCP 46 (telephony).
#            le: DSCP 1 (lower-effort).
#      lowdelay: Lowdelay data (IPTOS).
#    throughput: High-throughput data (IPTOS).
#   reliability: High-reliability data (IPTOS).
#             #: Raw numeric value for DSCP field.
#            '': Use static defaults.
#
# Default:
#   - 'lowdelay'
#   - 'throughput'
#
# Reference:
# * https://en.wikipedia.org/wiki/Differentiated_services
# * https://en.wikipedia.org/wiki/Type_of_service
ssh_server_ip_qos:
  - 'lowdelay'
  - 'throughput'

# Use keyboard-interactive authentication? Default: False.
ssh_server_kbd_interactive_authentication: false

# Validate ssh_server_password_authentication through Kerberos KDC?
#
# Server needs a Kerberos servtab which allows verification of KDC's identity.
#
# Enabling this option will trigger kerberos dependencies to install; see
# vars/ssh_role_kerberos_minimum_packages.
#
# Default: False.
ssh_server_kerberos_authentication: false

# Get AFS token before accessing user home directory?
#
# Special Case:
# * Do NOT enable - openssh-server is compiled WITHOUT kerberos supported.
#   Installing required kerberos packages will not enable kerberos AFS support.
#
# This option provided for completeness of sshd_config options but will NOT be
# deployed to sshd_config as existence of this option will prevent SSHD from
# starting.
#
# Default: False.
#
# Reference:
# * https://github.com/clearlinux-pkgs/openssh/blob/05440f1924e9cada620444f21c181d790d27666c/configure
ssh_server_kerberos_get_afs_token: false

# Validate password with local mechanisms if Kerberos fails? Default: True.
ssh_server_kerberos_or_local_passwd: true

# Destroy user ticket cache file on logout? Default: True.
ssh_server_kerberos_ticket_cleanup: true

# Available KEX (key exchange) algorithms.
#
# List supported KEX algorithms with:
#
#   ssh -Q kex
#
# Special Case:
# * Algorithm lists cannot use modifiers (+, -, etc).
#
# Default:
#   - 'mlkem768x25519-sha256'
#   - 'sntrup761x25519-sha512'
#   - 'sntrup761x25519-sha512@openssh.com'
#   - 'curve25519-sha256'
#   - 'curve25519-sha256@libssh.org'
#   - 'ecdh-sha2-nistp256'
#   - 'ecdh-sha2-nistp384'
#   - 'ecdh-sha2-nistp521'
ssh_server_kex_algorithms:
  - 'mlkem768x25519-sha256'
  - 'sntrup761x25519-sha512'
  - 'sntrup761x25519-sha512@openssh.com'
  - 'curve25519-sha256'
  - 'curve25519-sha256@libssh.org'
  - 'ecdh-sha2-nistp256'
  - 'ecdh-sha2-nistp384'
  - 'ecdh-sha2-nistp521'

# Local listen addresses for SSHD.
#
# Special Case:
#   {IPv6}: Enclose IPv6 addresses in square brackets ([::]).
#
# Values:
#   {HOSTNAME}|{ADDRESS}[:{PORT}]: Listen address. If port is not specified
#                                  SSHD will listen on address and all Port
#                                  options specified.
#
# Default: (listen on all local addresses IPv4/6).
#   - '[::]:22'
#   - '0.0.0.0:22'
ssh_server_listen_address:
  - '[::]:22'
  - '0.0.0.0:22'

# Disconnect user after time (in seconds) if not successfully logged in?
#
# Values:
#   {TIME}: Disconect after idle for specified TIME FORMAT.
#        0: Disable time limit.
#
# Default: 120 (seconds).
ssh_server_login_grace_time: 120

# SSHD log level.
#
# Logging with a DEBUG level violates privacy of users and is NOT recommended.
#
# Values:
#     QUIET: No logging.
#     FATAL: Fatal errors only.
#     ERROR: Fatal and non-fatal errors.
#      INFO: Informational and ERROR, FATAL (default).
#   VERBOSE: Extra information and INFO.
#     DEBUG: Equivalent to DEBUG1, log extra details and VERBOSE.
#    DEBUG1: Equivalent to DEBUG, log extra details and VERBOSE.
#    DEBUG2: Log even more details and VERBOSE, DEBUG.
#    DEBUG3: Log everything.
#
# Default: 'INFO'.
ssh_server_log_level: 'INFO'

# Specify one or more overrides to LogLevel.
#
# An override consists of a pattern lists that matches the source file,
# function and line number to force detailed logging for. For example an
# override pattern of:
#
# ssh_client_log_verbose:
#   - 'kex.c:*:1000'
#   - '*:kex_exchange_identification():*'
#   - 'packet.c:*'
#
# Would enable detailed logging for line 1000 of kex.c, everything in the
# kex_exchange_identification() function, and all code in the packet.c file.
# This option is intended for debugging.
#
# Default: [] (no overrides).
ssh_server_log_verbose: []

# MAC (message authentication code) algorithms in order of preference.
#
# Algorithms that contain '-etm' calculate the MAC after encryption
# (encrypt-then-mac). These are considered safer and their use recommended.
# List supported MACs with:
#
#   ssh -Q MACs
#
# Security: CVE-2023-48795
#   CVE:
#   * https://nvd.nist.gov/vuln/detail/cve-2023-48795
#   * https://nvd.nist.gov/vuln/detail/cve-2023-46445
#   * https://nvd.nist.gov/vuln/detail/cve-2023-46446
#   * https://nvd.nist.gov/vuln/detail/cve-2024-41909
#   Decision: Remove chacha20 cipher, *-etm MAC - disables attack for modern
#       systems, remove when OpenSSH 9.6 released with strict key exchange.
#   Mitigation:
#   * Remove 'chacha20-poly1305@openssh.com' from client ciphers.
#   * Remove '*-etm@openssh.com' from server macs.
#   Reference:
#   * https://terrapin-attack.com/#scanner
#   * https://www.openssh.com/txt/release-9.6
#
# Special Case:
# * Algorithm lists cannot use modifiers (+, -, etc).
#
# Default:
#   # - 'umac-64-etm@openssh.com'
#   # - 'umac-128-etm@openssh.com'
#   # - 'hmac-sha2-256-etm@openssh.com'
#   # - 'hmac-sha2-512-etm@openssh.com'
#   # - 'hmac-sha1-etm@openssh.com'
#   - 'umac-64@openssh.com'
#   - 'umac-128@openssh.com'
#   - 'hmac-sha2-256'
#   - 'hmac-sha2-512'
#   - 'hmac-sha1'
ssh_server_macs:
  - 'umac-64@openssh.com'
  - 'umac-128@openssh.com'
  - 'hmac-sha2-256'
  - 'hmac-sha2-512'
  - 'hmac-sha1'

# Max authentication attempts permitted per connection.
#
# Additional failures are logged after reaching half of this value.
#
# Default: 6.
ssh_server_max_auth_tries: 6

# Max number of open sessions permitted per network connection.
#
# A session is a shell, login or subsystem (e.g. sftp). Multiple sessions may
# be established by clients that support connection multiplexing.
#
# Special Case:
#   0: Prevent all shell, login, subsystem sessions while permitting
#      forwarding.
#   1: Effectively disables session multiplexing.
#
# Default: 10.
ssh_server_max_sessions: 10

# Max concurrent unauthenticated connections to the SSH daemon.
#
# Additional connections will be dropped until authentication succeeds or
# ssh_server_login_grace_time expires for a connection.
#
# ssh_server_max_startups:
#     dict - Start/rate/full startup specification.
#   start: int - Number of started unauthenticated connections.
#   rate: int - Probability of refusing unauthenticated connections (rate/100).
#       Optional.
#   full: int - Refuse all connections after this limit. Optional.
#
# ssh_server_max_startups:
#   start: 10
#
# Default:
#   start: 10
#   rate: 30
#   full: 100
ssh_server_max_startups:
  start: 10
  rate: 30
  full: 100

# Moduli file containing Diffie-Hellman groups used for DH key exchange.
#
# Default: '/etc/ssh/moduli'.
ssh_server_moduli_file: '/etc/ssh/moduli'

# Service name used for Pluggable Authentication Modules (PAM).
#
# Default: 'sshd'.
ssh_server_pam_service_name: 'sshd'

# Use password authentication? Default: True.
ssh_server_password_authentication: true

# Allow login with empty password strings. Default: False.
ssh_server_permit_empty_passwords: false

# Addresses and ports that remote TCP port forwarding may listen.
#

# Special Case:
#          []: 'none' - Disabled.
#         any: Remove all restrictions, permit any listen requests (default).
#          '': Prohibit all listen requests.
#         ::1: Treated differently than SSH requested 'localhost'.
#   127.0.0.1: Treated differently than SSH requested 'localhost'.
#   {PATTERN}: PATTERN host match.
#      {IPv6}: Enclose IPv6 addresses in square brackets ([::]).
#
# Values:
#   [{ADDRESS}:]{PORT}: Remote TCP port forwarding bind address. Wildcard (*)
#                       may be used to allow all ports.
#
# ssh_server_permit_listen:
#   - ''
#
# ssh_server_permit_listen:
#   - '127.0.0.1:22'
#
# Default: ['any'].
ssh_server_permit_listen:
  - 'any'

# Permitted TCP port forwarding destinations.
#
# No pattern matching is done except for Special Cases.
#
# Special Case:
#    any: Remove all restrictions and permit any forward requests (default).
#   none: Prohibit all forwarding requests.
#      *: May be used for any host or port to allow all.
#
# Values:
#     {HOST}:{PORT}: DNS port.
#     {IPv4}:{PORT}: IPv4 port.
#   [{IPv6}]:{PORT}: IPv6 port.
#
# ssh_server_permit_open:
#   - 'localhost:1000'
#   - '192.168.0.3:*'
#   - '[::]:1500'
#
# Default: ['any'].
ssh_server_permit_open:
  - 'any'

# Allow root to login via SSH?
#
# Values:
#                   True: Allow root login.
#      prohibit-password: Allow (disable password, keyboard authentication)
#                         (default).
#       without-password: Prohibit-password alias (deprecated).
#   forced-commands-only: Allow public key authentication ONLY if command
#                         option has been specified (which may be useful for
#                         taking remote backups even if root login is normally
#                         not allowed). All other authentication methods are
#                         disabled for root.
#                  False: Do NOT allow root login.
#
# Default: 'prohibit-password'.
ssh_server_permit_root_login: 'prohibit-password'

# Allow pseudo-tty (pty) allocations? Default: True.
ssh_server_permit_tty: true

# Allow tunnel device forwarding between client and server?
#
# Permissions of selected tunnel device must allow access to user.
#
# Values:
#             True: Permits both point-to-point and ethernet.
#   point-to-point: Layer 3.
#         ethernet: Layer 2.
#            False: No tunneling (default).
#
# Default: False (disabled).
ssh_server_permit_tunnel: false

# Process user environment options in SSHD.
#
# Options processed are ~/.ssh/environment and environment= options in
# ~/.ssh/authorized_keys. Enabling environment processing may enable users to
# bypass access restrictions in some configurations using mechanisms such as
# LD_PRELOAD.
#
# Values:
#        True: Allow user environments.
#   {PATTERN}: list of PATTERN - PATTERN specification for accpted environment
#              names.
#       False: Do NOT allow user environments (default).
#
# ssh_server_permit_user_environment:
#   - 'LANG'
#   - 'LC*'
#
# Default: False (disabled).
ssh_server_permit_user_environment: false

# Allow ~/.ssh/rc execution? Default: True.
ssh_server_permit_user_rc: true

# Max unauthenticated connections allowed from a given source address.
#
# Applied in addition to ssh_server_max_startups - whichever is lower.
#
# Special Case:
#   -1: 'none' - No limit (disabled) (default).
#
# Default: -1 (disabled).
ssh_server_per_source_max_startups: -1

# Source address netblock bits to apply ssh_server_per_source_max_startups to.
#
# ssh_server_per_source_net_block_size:
#   ipv4: int - Bits in IPv4 netblock to consider (ALL IPv4/6 if only value).
#   ipv6: int - Bits in IPv6 netblock to consider.
#
# ssh_server_per_source_net_block_size:
#   ipv4: 32
#
# Default:
#   ipv4: 32
#   ipv6:128
ssh_server_per_source_net_block_size:
  ipv4: 32
  ipv6: 128

# Penalties for various conditions that may represent attacks on SSHD.
#
# If a penalty is enforced against a client then its source address and any
# others in the same network, as defined by
# ssh_server_per_source_net_block_size, will be refused connection for a
# period. A penalty doesn't affect concurrent connections in progress, but
# multiple penalties from the same source from concurrent connections will
# accumulate up to a maximum. Conversely, penalties are not applied until a
# minimum threshold time has been accumulated.
#
# ssh_server_per_source_penalties:
#     list of dict - One or more channel type and time specifications.
#   - crash: TIME - How long to refuse clients that cause a crash of sshd.
#   - authfail: TIME - How long to refuse clients that disconnect after making
#         one or more unsuccessful authentication attempts.
#   - refuseconnection: TIME - How long to refuse clients that were
#         administratively prohibited connection via the
#         ssh_servedr_refuse_connection option.
#   - noauth: TIME - How long to refuse clients that disconnect without
#         attempting authentication. This timeout should be used cautiously
#         otherwise it may penalise legitimate scanning tools such as
#         ssh-keyscan.
#   - grace-exceeded: TIME - How long to refuse clients that fail to
#         authenticate after ssh_server_login_grace_time.
#   - max: TIME - Maximum time a particular source address range will be
#         refused access for. Repeated penalties will accumulate up to this
#         maximum.
#   - min: TIME - Minimum penalty that must accrue before enforcement begins.
#   - max-sources4: int - Maximum number of client IPv4 and IPv6 address ranges
#         to track for penalties (default: 65536 for both).
#   - max-sources6: int - Maximum number of client IPv4 and IPv6 address ranges
#         to track for penalties (default: 65536 for both).
#   - overflow: str - Server behavior when max-sources4 or max-sources6 is
#         exceeded.
#         Values:
#             deny-all: Deny all incoming connections other than those exempted
#                       via ssh_server_per_source_penalty_exempt_list until
#                       penalty expires.
#           permissive: Allows new connections by removing existing penalties
#                       early. Client penalties below the min threshold count
#                       against the total number of tracked penalties. IPv4 and
#                       IPv6 addresses are tracked separately, so an overflow
#                       in one will not affect the other.
#   - overflow6: str - Specifying a different overflow mode for IPv6 addresses.
#         Values:
#             deny-all: Deny all incoming connections other than those exempted
#                       via ssh_server_per_source_penalty_exempt_list until
#                       penalty expires.
#           permissive: Allows new connections by removing existing penalties
#                       early. Client penalties below the min threshold count
#                       against the total number of tracked penalties. IPv4 and
#                       IPv6 addresses are tracked separately, so an overflow
#                       in one will not affect the other.
#
# Default:
#   - crash: '90s'
#   - authfail: '5s'
#   - refuseconnection: '10s'
#   - noauth: '1s'
#   - grace-exceeded: '10s'
#   - max: '10m'
#   - min: '15s'
#   - max-sources4: 65536
#   - max-sources6: 65536
#   - overflow: 'permissive'
#   - overflow6: 'permissive'
ssh_server_per_source_penalties:
  - crash: '90s'
  - authfail: '5s'
  - refuseconnection: '10s'
  - noauth: '1s'
  - grace-exceeded: '10s'
  - max: '10m'
  - min: '15s'
  - max-sources4: 65536
  - max-sources6: 65536
  - overflow: 'permissive'
  - overflow6: 'permissive'

# List of addresses exempt from penalties.
#
# Mask length provided must be consistent with address - it is an error to
# specify a mask length that is too long for address or one with bits set in
# the host portion of address. For example, 192.0.2.0/33 and 192.0.2.0/8.
#
# Special Case:
#    *: Wildcards may be used.
#   []: 'none' - no exemptions (disabled) (default).
#
# Values:
#   {CIDR}: CIDR notation.
#     {IP}: IPv4/IPv6.
#
# Default: [] (disabled).
ssh_server_per_source_penalty_exempt_list: []

# Process ID file of SSHD. Default: '/run/sshd.pid'.
ssh_server_pid_file: '/run/sshd.pid'

# List of ports that SSHD listens on. Default: [22].
ssh_server_port:
  - 22

# Print time/date of last user login for interactive login? Default: True.
ssh_server_print_last_log: true

# Print /etc/motd for interactive login? Default: True.
ssh_server_print_motd: true

# Signatures to accept for public key authentication.
#
# List supported algorithms with:
#
#   ssh -Q PubkeyAcceptedAlgorithms
#
# Special Case:
# * Algorithm lists cannot use modifiers (+, -, etc).
#
# Default:
#   - 'ssh-ed25519-cert-v01@openssh.com'
#   - 'ecdsa-sha2-nistp256-cert-v01@openssh.com'
#   - 'ecdsa-sha2-nistp384-cert-v01@openssh.com'
#   - 'ecdsa-sha2-nistp521-cert-v01@openssh.com'
#   - 'sk-ssh-ed25519-cert-v01@openssh.com'
#   - 'sk-ecdsa-sha2-nistp256-cert-v01@openssh.com'
#   - 'rsa-sha2-512-cert-v01@openssh.com'
#   - 'rsa-sha2-256-cert-v01@openssh.com'
#   - 'ssh-ed25519'
#   - 'ecdsa-sha2-nistp256'
#   - 'ecdsa-sha2-nistp384'
#   - 'ecdsa-sha2-nistp521'
#   - 'sk-ssh-ed25519@openssh.com'
#   - 'sk-ecdsa-sha2-nistp256@openssh.com'
#   - 'rsa-sha2-512'
#   - 'rsa-sha2-256'
ssh_server_pubkey_accepted_algorithms:
  - 'ssh-ed25519-cert-v01@openssh.com'
  - 'ecdsa-sha2-nistp256-cert-v01@openssh.com'
  - 'ecdsa-sha2-nistp384-cert-v01@openssh.com'
  - 'ecdsa-sha2-nistp521-cert-v01@openssh.com'
  - 'sk-ssh-ed25519-cert-v01@openssh.com'
  - 'sk-ecdsa-sha2-nistp256-cert-v01@openssh.com'
  - 'rsa-sha2-512-cert-v01@openssh.com'
  - 'rsa-sha2-256-cert-v01@openssh.com'
  - 'ssh-ed25519'
  - 'ecdsa-sha2-nistp256'
  - 'ecdsa-sha2-nistp384'
  - 'ecdsa-sha2-nistp521'
  - 'sk-ssh-ed25519@openssh.com'
  - 'sk-ecdsa-sha2-nistp256@openssh.com'
  - 'rsa-sha2-512'
  - 'rsa-sha2-256'

# Set one or more public key authentication options.
#
# Special Case:
#   []: 'none' - no additional options enabled (default).
#
# Values:
#    touch-required: FIDO authenticator (ecdsa-sk or ed25519-sk) to always
#                    require the signature to attest that a physically present
#                    user explicitly confirmed the authentication (usually by
#                    touching the authenticator). By default SSHD requires user
#                    presence unless overridden with an authorized_keys option.
#                    The touch-required flag disables this override.
#   verify-required: FIDO key signature attest that the user was verified, e.g.
#                    via a PIN.
#
# Neither touch-required or verify-required options have any effect for other,
# non-FIDO, public key types.
#
# Default: [] (no additional options).
ssh_server_pubkey_auth_options: []

# Allow public key authentication?
#
# WARNING
# > Locked accounts cannot SSH pubkey auth.
# >
# > SSH now distinguishes between '!' and '*' password locking:
# >   *: Lock password - allow SSH pubkey auth.
# >   !: Lock password - deny SSH pubkey auth.
# >
# > Any other means to lock the password will result in SSH pubkey failures. Do
# > NOT set ssh_server_use_pam=true as this leads to security vulnerabilites.
# >
# > Reference:
# > * https://arlimus.github.io/articles/usepam/
# > * https://unix.stackexchange.com/questions/193066/how-to-unlock-account-for-public-key-ssh-authorization-but-not-for-password-aut
#
# Default: True.
ssh_server_pubkey_authentication: true

# Unconditionally terminate connection?
#
# A refuse connection penalty may be recorded against source of  connection if
# ssh_server_per_source_penalties are enabled. This option is only really
# useful in a Match block.
#
# Default: False.
ssh_server_refuse_connection: false

# Session rekey limits.
#
# ssh_server_rekey_limit:
#     dict - SSH rekey limits.
#   data: str - Max data transmitted/received before session key renegotiation.
#       Valid suffixes:
#         K: Kilobytes.
#         M: Megabytes.
#         G: Gigabytes.
#       Default: '0' (use cipher limit).
#   time: TIME FORMAT - Max amount of time before session key renegotiation.
#       Special Case:
#         '': No time based session key renegotiation.
#       Default: '0' (use cipher limit).
#
# Default: (use cipher limits).
#   data: '0'
#   time: '0'
ssh_server_rekey_limit:
  data: '0'
  time: '0'

# Minimum RSA key size (may only be increased from 1024). Default: 1024.
ssh_server_required_rsa_size: 1024

# Revoked public key file.
#
# If file does not exist or is not readable, authentication will be refused for
# all users. Keys may be specified as a text file listing one
# public key per line or as an OpenSSH Key Revocation List (KRL).
#
# Special Case:
#   '': 'none' - no revocations (disabled) (default).
#
# Default: '' (disabled).
#
# Reference:
# * https://manpages.debian.org/trixie/openssh-client/ssh-keygen.1.en.html#KEY_REVOCATION_LISTS
ssh_server_revoked_keys: ''

# Library path for loading any FIDO-based authenticator-hosted keys.
#
# Overrides default use of built-in USB HID support.
#
# Special Case:
#   ^$*: String starting with '$' will be treated as environment variable
#        containing the path to the library.
#
# Default: 'internal'.
ssh_server_security_key_provider: 'internal'

# Environment variables and contents set in child sessions started by SSHD.
#
# Spaces require quotes. Environment variables set by ssh_server_set_env
# override default environment and any variables specified by user via
# ssh_server_accept_env or ssh_server_permit_user_environment.
#
# ssh_server_set_env:
#   - 'TEST_ENV="value with spaces"'
#
# Default: [] (disabled).
ssh_server_set_env: []

# Override default path to sshd-auth binary.
#
# This option is intended for use by tests.
#
# Default: '/usr/lib/openssh/sshd-auth'.
ssh_server_sshd_auth_path: '/usr/lib/openssh/sshd-auth'

# Override default path to sshd-session binary
#
# This option is intended for use by tests.
#
# Default: '/usr/lib/openssh/sshd-session'.
ssh_server_sshd_session_path: '/usr/lib/openssh/sshd-session'

# Octal file creation mode mask (umask) when creating a Unix-domain socket.
#
# This option is only used for port forwarding to a Unix-domain socket file.
#
# Default: '0177'.
ssh_server_stream_local_bind_mask: '0177'

# Remove existing Unix-domain socket file before creating a new one?
#
# This option is only used for port forwarding to a Unix-domain socket file.
#
# If socket file already exists and ssh_server_stream_local_bind_unlink is not
# enabled, SSHD will be unable to forward the port to the Unix-domain socket
# file.
#
# Default: False.
ssh_server_stream_local_bind_unlink: false

# Check file modes/ownership of user files/home directory before login?
#
# Novices sometimes accidentally leave their directory or files world-writable.
# Does not apply to ssh_server_chroot_directory, whose permissions and
# ownership are checked unconditionally.
#
# Default: True.
ssh_server_strict_modes: true

# Configure external subsystems.
#
# ssh_server_subsystem:
#     list of dict - Subsystem type and configuration.
#   - system: str - Subsystem type (sftp, scp, tunnel, etc).
#     config: str - Subsystem config (/usr/lib/openssh/sftp-server).
#
# ssh_server_subsystem:
#   - system: 'sftp'
#     config: 'internal-sftp'
#   - system: 'scp'
#     config: 'internal-sftp'
#
# Default:
#   - system: 'sftp'
#     config: '/usr/lib/openssh/sftp-server'
ssh_server_subsystem:
  - system: 'sftp'
    config: '/usr/lib/openssh/sftp-server'

# Syslog facility code used when logging messages from SSHD.
#
# Values:
#   DAEMON: System daemon messages.
#     USER: User-level messages.
#     AUTH: Security/authorization messages (default).
#   LOCAL0: Local use 0.
#   LOCAL1: Local use 1.
#   LOCAL2: Local use 2.
#   LOCAL3: Local use 3.
#   LOCAL4: Local use 4.
#   LOCAL5: Local use 5.
#   LOCAL6: Local use 6.
#   LOCAL7: Local use 7.
#
# Default: 'AUTH'.
ssh_server_syslog_facility: 'AUTH'

# Send TCP keepalive messages?
#
# Detect when connection death or crash of one of the machines happens.
#
# Consider ssh_server_client_alive_interval as well.
#
# Default: True.
ssh_server_tcp_keep_alive: true

# Public keys of trusted CAs.
#
# These are trusted to sign user certificates for authentication. If a
# certificate is presented for authentication and has its signing CA key listed
# in this file, then it may be used for authentication for any user listed in
# the certificate's principals list. Note that certificates that lack a list of
# principals will not be permitted for authentication using
# ssh_server_trusted_user_ca_keys.
#
# Values:
#   {CONTENTS}: Contents of trusted CA keys - file automatically managed in
#               /etc/ssh/ssh_server_trusted_user_ca_keys.
#           '': 'none' - disabled (default).
#
# Default: '' (disabled).
#
# Reference:
# * https://manpages.debian.org/trixie/openssh-client/ssh-keygen.1.en.html#CERTIFICATES
ssh_server_trusted_user_ca_keys: ''

# Close client connections with no open channels.
#
# Open channels include active shell, command execution or subsystem sessions,
# connected network, socket, agent or X11 forwardings. Forwarding listeners,
# are not considered as open channels and do not prevent the timeout.
#
# Note that this timeout starts when the client connection completes user
# authentication but before the client has an opportunity to open any channels.
# Caution should be used when using short timeout values, as they may not
# provide sufficient time for the client to request and open its channels
# before terminating the connection.
#
# This option may be useful in conjunction with ssh_server_channel_timeout.
#
# Values:
#   {TIME}: Connection timout TIME specification.
#       '': 'none' - never expire connections (default).
#
# Default: '' (disabled).
ssh_server_unused_connection_timeout: ''

# Verify resolved host name for remote IP maps back to same IP?
#
# If disabled only addresses and not host names may be used in
# ~/.ssh/authorized_keys from and sshd_config Match Host directives.
#
# Default: False.
ssh_server_use_dns: false

# Enable Pluggable Authentication Module (PAM) interface?
#
# Enables PAM authentication using ssh_server_kbd_interactive_authentication
# and ssh_server_password_authentication in addition to PAM account and session
# module processing for all authentication types. Because PAM
# keyboard-interactive authentication usually serves an equivalent role to
# password authentication, disable either ssh_server_password_authentication
# or ssh_server_kbd_interactive_authentication.
#
# Enabling with passwordless accounts will lead to security vulnerabilites. If
# enabled SSHD will not run as a non-root user.
#
# Security:
#   CVE: https://arlimus.github.io/articles/usepam/
#   Decision: disable - PAM enables locked accounts '!' ability to login via
#       SSH.
#   Mitigation: Use '*' instead and keep PAM disabled.
#   Reference:
#   * https://unix.stackexchange.com/questions/193066/how-to-unlock-account-for-public-key-ssh-authorization-but-not-for-password-aut
#
# Default: False.
ssh_server_use_pam: false

# Text to append to SSH protocol banner on connection.
#
# Special Case:
#   '': 'none' - disable (default).
#
# Default: '' (disabled).
ssh_server_version_addendum: ''

# Specifies first display number available for SSHD X11 forwarding.
#
# This prevents SSHD from interfering with real X11 servers.
#
# Default: 10.
ssh_server_x11_display_offset: 10

# Permit X11 forwarding?
#
# There may be additional exposure to server and to client displays if SSHD
# proxy display is configured to listen on wildcard address (see
# ssh_server_x11_use_localhost), though this is not the default. Additionally
# authentication spoofing, authentication data verification, and substitution
# occur on client side. The security risk of using X11 forwarding is that
# client's X11 display server may be exposed to attack when SSH client requests
# forwarding (see ssh_client_forward_x11).
#
# Note that disabling X11 forwarding does not prevent users from forwarding X11
# traffic, as users can always install their own forwarders.
#
# Default: True.
ssh_server_x11_forwarding: true

# Bind X11 forwarding server to loopback address instead of wildcard address?
#
# SSHD binds forwarding server to loopback address and sets hostname part of
# DISPLAY environment variable to localhost. This prevents remote hosts from
# connecting to proxy display. Some older X11 clients may not function with
# this configuration.
#
# Default: True.
ssh_server_x11_use_localhost: true

# Full path to xauth. Default: '/usr/bin/xauth'.
ssh_server_xauth_location: '/usr/bin/xauth'

###############################################################################
# SSHD Includes Directory (/etc/ssh/sshd_config.d)
###############################################################################
# Manage files within the first directory listed in ssh_server_include.
#
# ssh_server_include_files:
#     list of dict - For sshd_config local configuration..
#   - config: str - Name of local config ({INCLUDE}/{CONFIG}).
#     state: str - Whether config should be managed or removed.
#         Values:
#           present: Manage configuration.
#            absent: Remove configuration.
#         Default: 'present'.
#     options: str - sshd_config options to manage (per sshd_config options).
#
# ssh_server_include:
#   - '/etc/ssh/sshd_config.d/*.conf'
#
# ssh_server_include_files:
#   - config: 'custom_sshd_config'
#     state: 'present'
#     options: |
#       Host *
#         AllowAgentForwarding yes
#  - config: 'old_sshd_config'
#    state: 'absent'
#
# File created: /etc/ssh/sshd_config.d/custom_ssh_config
#
# Default: [] (un-managed).
#
# Reference:
# * https://manpages.debian.org/trixie/openssh-server/sshd_config.5.en.html
ssh_server_include_files: []
